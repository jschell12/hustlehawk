!function(a,b){"use strict";var c=13;b.data.binders.enter=b.data.Binder.extend({init:function(d,e,f){b.data.Binder.fn.init.call(this,d,e,f),a(this.element).bind("keyup",function(a){a.which===c&&this.element.value.trim()&&this.bindings.enter.get()}.bind(this))},refresh:function(){}})}($,kendo),function(a,b){a.Utils=a.Utils||{};var c=a.Utils.TemplateLoader=function(a){var b=this;b._transport=a};c.prototype={load:function(a,c){var d=this;a.length>1?d._transport.load({url:a[0]},function(e){b("body").append(e),a.splice(0,1),d.load(a,c)}):d._transport.load({url:a[0]},function(a){b("body").append(a),c()})}}}(window.app=window.app||{},jQuery),function(){app.Utils=app.Utils||{};var a=app.Utils.OauthWindow=function(a,b,c){this.authenticateUrl=a,this.interval=b||1e3,this.windowParams=c||"location=0,status=0,width=800,height=600"};return a.prototype={open:function(){var a=this;a.oauth_window=window.open(a.authenticateUrl,"oauthWindow",a.windowParams),a.checkConnect=setInterval(function(){a.oauth_window.location&&a.oauth_window.location.host&&a.oauth_window.close(),a.oauth_window&&a.oauth_window.closed&&(clearInterval(a.checkConnect),window.location.reload())},a.interval)}},a}(),function(a,b,c){a.Utils=a.Utils||{};var d=a.Utils.Transport=function(){var a=this;return a};return d.prototype={init:function(){},"delete":function(a,d){var e=a.url||"",f=a.params||{};b.ajax({url:e,type:"DELETE",dataType:"json",contentType:"application/json; charset=UTF-8",data:c.stringify(f)}).done(d)},_isEmpty:function(a){if(!a)return!1;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},get:function(a,c){var d=this,e=a.url||"",f=a.params||{};d._isEmpty(f)&&(f=""),b.ajax({url:e,type:"GET",dataType:"json",data:d._toURLParams(f)}).done(c)},load:function(a,c){var d=this,e=a.url||"",f=a.params||{};d._isEmpty(f)&&(f=""),b.ajax({url:e,type:"GET",dataType:"HTML",data:d._toURLParams(f)}).done(c)},post:function(a,d){var e=a.url||"",f=a.params||{};b.ajax({url:e,type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",data:c.stringify(f)}).done(d)},put:function(a,d){var e=a.url||"",f=a.params||{};b.ajax({url:e,type:"PUT",dataType:"json",contentType:"application/json; charset=UTF-8",data:c.stringify(f)}).done(d)},_toURLParams:function(a){var b=[];if(a=a||null,!a)return"";for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];if("[object Array]"===Object.prototype.toString.call(d))for(var e=0;e<d.length;e++)b.push(encodeURIComponent(c)+"="+encodeURIComponent(d[e]));else b.push(encodeURIComponent(c)+"="+encodeURIComponent(d))}return b.join("&")}},d}(window.app=window.app||{},jQuery,kendo),function(a){a.Utils=a.Utils||{};var b=a.Utils.WebSocketTransport=function(a){var b=this;return b._socket=a,b};return b.prototype={init:function(){},receiveOn:function(a,b){var c=this;c._socket.on(a,b)},send:function(a,b){var c=this;c._socket.emit(a,b)}},b}(window.app=window.app||{},jQuery);var app=app||{};!function(a,b,c,d){function e(){return geoip_city()+", "+geoip_region()}function f(b){for(var c=a.JobFeedViewModel,d=c.get("jobs")||[],e=d.toJSON(),f=0,g=b.length;g>f;f++){var h=b[f];e.push(h)}e.sort(function(a,b){return a.timestamp>b.timestamp?-1:a.timestamp<b.timestamp?1:0}),c.set("jobs",e)}a.Transport=new a.Utils.Transport,a.PubSub=new c.Observable;var g=new a.Utils.TemplateLoader(a.Transport);a.Utils.Common,g.load(["/tmpl/user-tmpl.html","/tmpl/job-tmpl.html","/tmpl/layout-tmpl.html"],function(){a.PubSub.trigger("loaded:templates")}),a.NavViewModel=new c.observable({}),a.NavLayout=new c.Layout("nav-layout-tmpl",{wrap:!1,model:a.NavViewModel}),a.AppLayout=new c.Layout("app-layout-tmpl",{wrap:!1}),a.IndeedDataSource=new c.data.DataSource({transport:{read:function(b){var c=b.data;a.Transport.get({url:"/api/jobs/indeed",params:c},function(a){b.success(a)})}}}),a.CareerBuilderDataSource=new c.data.DataSource({transport:{read:function(b){var c=b.data;a.Transport.get({url:"/api/jobs/careerbuilder",params:c},function(a){b.success(a)})}}}),a.CareerJetDataSource=new c.data.DataSource({transport:{read:function(b){var c=b.data;a.Transport.get({url:"/api/jobs/careerjet",params:c},function(a){b.success(a)})}}}),a.LinkUpDataSource=new c.data.DataSource({transport:{read:function(b){var c=b.data;a.Transport.get({url:"/api/jobs/linkup",params:c},function(a){b.success(a)})}}}),a.SimplyHiredDataSource=new c.data.DataSource({transport:{read:function(b){var c=b.data;a.Transport.get({url:"/api/jobs/simplyhired",params:c},function(a){b.success(a)})}}}),a.IndeedDataSource.bind("change",function(){f(this.view())}),a.CareerBuilderDataSource.bind("change",function(){f(this.view())}),a.CareerJetDataSource.bind("change",function(){f(this.view())}),a.LinkUpDataSource.bind("change",function(){f(this.view())}),a.SimplyHiredDataSource.bind("change",function(){f(this.view())}),a.JobFeedViewModel=new c.observable({jobs:[],keywords:"",location:"",userIsLoggedIn:function(){return a.UserViewModel.isLoggedIn()},reloadLinkedinBasedResults:function(){this.set("keywords",""),this.search()},search:function(){var b=a.JobFeedViewModel;b.set("jobs",[]);var c=this.get("keywords"),d=this.get("location");d&&(a.IndeedDataSource.read({keywords:c,location:d}),a.SimplyHiredDataSource.read({keywords:c,location:d}),a.CareerJetDataSource.read({keywords:c,location:d}),a.CareerBuilderDataSource.read({keywords:c,location:d}),a.LinkUpDataSource.read({keywords:c,location:d}))}}),a.JobFeedView=new c.View("job-list-tmpl",{model:a.JobFeedViewModel,init:function(){b(this.element).find("ul").data("kendoListView")}}),a.Router=new c.Router({init:function(){a.NavLayout.render("#app-nav"),a.AppLayout.render("#app")},routeMissing:function(a){console.log("routeMissing",a.url)}}),a.Router.route("/",function(){a.AppLayout.showIn("#view",a.JobFeedView);var b=e();a.JobFeedViewModel.set("location",b),a.JobFeedViewModel.search()}),a.Router.route("/profile",function(){var b=a.UserViewModel;b.isLoggedIn()?a.AppLayout.showIn("#view",a.UserProfileView):a.Router.navigate("/")}),a.Router.route("/contact",function(){a.AppLayout.showIn("#view",a.ContactView)}),a.UserModel=new c.data.Model.define({id:"id",fields:{id:{type:"string",editable:!1},displayName:{type:"string",editable:!0},industry:{type:"string",editable:!0},interests:{type:"string",editable:!0},summary:{type:"string",editable:!0}}}),a.UserSkillModel=new c.data.Model.define({id:"id",fields:{id:{type:"number",editable:!1},name:{type:"string",editable:!0},toggled:{type:"boolean",editable:!0}}}),a.UserData=new c.data.DataSource({schema:{model:a.UserModel},transport:{read:function(b){var c=b.data;a.Transport.get({url:"/api/me",params:c},function(a){a.error?b.success({}):b.success(a.user)})},update:function(b){var c=b.data;a.Transport.put({url:"/api/me",params:c},function(a){a.error?b.success({}):b.success(a.user)})}}}),a.UserSkillsData=new c.data.DataSource({batch:!0,schema:{model:a.UserSkillModel},transport:{read:function(b){var c=b.data;a.Transport.get({url:"/api/me/skills",params:c},function(a){a.error?b.success({}):b.success(a.user)})},update:function(b){var c=b.data;a.Transport.put({url:"/api/me/skills",params:c},function(a){a.error?b.success({}):b.success(a.user)})}}}),a.UserViewModel=new c.observable({user:null,authenticateWithLinkedIn:function(){window.location.href="/auth/linkedin/"},isLoggedIn:function(){var a=this.get("user");return a&&a!==d?!0:!1},save:function(){a.UserSkillsData.sync()}}),a.UserLoggedOutMenuView=new c.View("user-loggedout-dropdown-tmpl",{model:a.UserViewModel,init:function(){},show:function(){}}),a.UserLoggedInMenuView=new c.View("user-loggedin-dropdown-tmpl",{model:a.UserViewModel,init:function(){},show:function(){}}),a.UserProfileView=new c.View("user-profile-tmpl",{model:a.UserViewModel,init:function(){var d=this,e=b(d.element);e.find(".skills-list").kendoListView({dataSource:a.UserSkillsData,selectable:!0,autoBind:!0,template:c.template(b("#skills-list-template").html()),change:function(){var a=this.dataSource.view(),c=b.map(this.select(),function(c){return a[b(c).index()]})[0];c.set("toggled",!c.toggled)}})},show:function(){}}),a.PubSub.bind("loaded:templates",function(){a.UserData.fetch(function(){var b=this.view()[0];b.id?(a.UserViewModel.set("user",b),a.NavLayout.showIn("#user",a.UserLoggedInMenuView)):a.NavLayout.showIn("#user",a.UserLoggedOutMenuView),a.Router.start()}),a.UserSkillsData.fetch(function(){})}),a.test={},a.test._updateJobs=f}(app=app||{},jQuery,kendo);